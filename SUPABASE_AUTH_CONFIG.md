# Supabase è®¤è¯é…ç½®æŒ‡å—

## ğŸš¨ é—®é¢˜è¯Šæ–­

å¦‚æœçœ‹åˆ°ä»¥ä¸‹é”™è¯¯ï¼š
```
POST https://xxx.supabase.co/auth/v1/token?grant_type=password
400 Bad Request
```

è¿™æ˜¯å› ä¸º Supabase é¡¹ç›®çš„è®¤è¯é…ç½®ä¸æ­£ç¡®ã€‚

---

## âœ… è§£å†³æ–¹æ¡ˆï¼šé…ç½® Supabase Authentication

### æ­¥éª¤ 1: æ‰“å¼€ Supabase Dashboard

1. è®¿é—® https://supabase.com/dashboard
2. é€‰æ‹©ä½ çš„é¡¹ç›®ï¼š`alojqjngnlgllzgowmku`

### æ­¥éª¤ 2: é…ç½® Email Auth

1. åœ¨å·¦ä¾§èœå•ç‚¹å‡» **Authentication** â†’ **Providers**
2. æ‰¾åˆ° **Email** provider
3. ç¡®ä¿å·²**å¯ç”¨** Email provider

### æ­¥éª¤ 3: å…³é—­é‚®ç®±ç¡®è®¤ï¼ˆå¼€å‘ç¯å¢ƒï¼‰

è¿™æ˜¯**æœ€é‡è¦çš„ä¸€æ­¥**ï¼Œå¦åˆ™æ— æ³•ç™»å½•ï¼

1. åœ¨å·¦ä¾§èœå•ç‚¹å‡» **Authentication** â†’ **Settings**
2. å‘ä¸‹æ»šåŠ¨æ‰¾åˆ° **User Signups** éƒ¨åˆ†
3. **å…³é—­** "Enable email confirmations"ï¼ˆå¼€å‘ç¯å¢ƒå»ºè®®å…³é—­ï¼‰
   - âœ… å…³é—­åå¯ä»¥ç›´æ¥æ³¨å†Œç™»å½•
   - âŒ å¼€å¯æ—¶éœ€è¦ç‚¹å‡»é‚®ä»¶ç¡®è®¤é“¾æ¥ï¼ˆå…è´¹è®¡åˆ’é‚®ä»¶é…é¢æœ‰é™ï¼‰

### æ­¥éª¤ 4: é…ç½®ç«™ç‚¹ URLï¼ˆé‡è¦ï¼‰

1. åœ¨ **Authentication** â†’ **URL Configuration**
2. è®¾ç½® **Site URL** ä¸ºä½ çš„åº”ç”¨åœ°å€ï¼š
   - å¼€å‘ç¯å¢ƒï¼š`http://localhost:3000`
   - ç”Ÿäº§ç¯å¢ƒï¼š`https://your-domain.com`
3. è®¾ç½® **Redirect URLs**ï¼ˆå¯é€‰ï¼‰ï¼š
   - `http://localhost:3000/**`
   - `https://your-domain.com/**`

### æ­¥éª¤ 5: ä¿å­˜å¹¶æµ‹è¯•

1. ç‚¹å‡» **Save** ä¿å­˜æ‰€æœ‰é…ç½®
2. ç­‰å¾…å‡ ç§’è®©é…ç½®ç”Ÿæ•ˆ
3. åˆ·æ–°ä½ çš„åº”ç”¨å¹¶å°è¯•æ³¨å†Œæ–°è´¦å·

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### 1. æ³¨å†Œæ–°è´¦å·

è®¿é—® `/auth/signin`ï¼Œå¡«å†™ï¼š
- **ç”¨æˆ·å**: test
- **é‚®ç®±**: test@example.com
- **å¯†ç **: test123456

ç‚¹å‡»"æ³¨å†Œ"æŒ‰é’®ã€‚

### 2. éªŒè¯æ³¨å†ŒæˆåŠŸ

åœ¨ Supabase Dashboardï¼š
1. **Authentication** â†’ **Users**
2. åº”è¯¥çœ‹åˆ°æ–°æ³¨å†Œçš„ç”¨æˆ·
3. ç¡®è®¤ `email_confirmed_at` å­—æ®µæœ‰å€¼ï¼ˆå¦‚æœå…³é—­äº†é‚®ç®±ç¡®è®¤ï¼‰

### 3. æµ‹è¯•ç™»å½•

ä½¿ç”¨åˆšæ‰æ³¨å†Œçš„è´¦å·ç™»å½•ã€‚

---

## ğŸ” å¸¸è§é”™è¯¯å’Œè§£å†³æ–¹æ¡ˆ

### é”™è¯¯ 1: "Email not confirmed"

**åŸå› **: å¯ç”¨äº†é‚®ç®±ç¡®è®¤ä½†æ²¡æœ‰ç‚¹å‡»ç¡®è®¤é“¾æ¥

**è§£å†³æ–¹æ¡ˆ**:
```sql
-- åœ¨ Supabase SQL Editor æ‰§è¡Œ
UPDATE auth.users
SET email_confirmed_at = NOW()
WHERE email = 'your-email@example.com';
```

æˆ–è€…å…³é—­é‚®ç®±ç¡®è®¤ï¼ˆæ¨èå¼€å‘ç¯å¢ƒï¼‰ã€‚

### é”™è¯¯ 2: "Invalid login credentials"

**åŸå› **:
- é‚®ç®±æˆ–å¯†ç é”™è¯¯
- ç”¨æˆ·ä¸å­˜åœ¨
- å¯†ç å¤ªçŸ­ï¼ˆSupabase é»˜è®¤æœ€å°‘ 6 ä½ï¼‰

**è§£å†³æ–¹æ¡ˆ**:
- ç¡®è®¤å¯†ç è‡³å°‘ 6 ä½
- å…ˆæ³¨å†Œå†ç™»å½•
- æ£€æŸ¥é‚®ç®±æ‹¼å†™

### é”™è¯¯ 3: "Email rate limit exceeded"

**åŸå› **: å‘é€äº†å¤ªå¤šç¡®è®¤é‚®ä»¶

**è§£å†³æ–¹æ¡ˆ**:
- ç­‰å¾…å‡ åˆ†é’Ÿ
- æˆ–å…³é—­é‚®ç®±ç¡®è®¤åŠŸèƒ½

### é”™è¯¯ 4: "User already registered"

**åŸå› **: è¯¥é‚®ç®±å·²è¢«æ³¨å†Œ

**è§£å†³æ–¹æ¡ˆ**:
- ä½¿ç”¨è¯¥é‚®ç®±ç™»å½•
- æˆ–è€…ä½¿ç”¨å¦ä¸€ä¸ªé‚®ç®±æ³¨å†Œ

---

## ğŸ›¡ï¸ ç”Ÿäº§ç¯å¢ƒå»ºè®®

### å¯ç”¨é‚®ç®±ç¡®è®¤

ç”Ÿäº§ç¯å¢ƒ**å»ºè®®å¯ç”¨**é‚®ç®±ç¡®è®¤ä»¥é˜²æ­¢æ»¥ç”¨ï¼š

1. **Authentication** â†’ **Settings**
2. **å¯ç”¨** "Enable email confirmations"
3. é…ç½® **SMTP Settings**ï¼ˆè‡ªå®šä¹‰é‚®ä»¶æœåŠ¡å™¨ï¼‰æˆ–ä½¿ç”¨ Supabase å†…ç½®é‚®ä»¶

### é…ç½®é‚®ä»¶æ¨¡æ¿

1. **Authentication** â†’ **Email Templates**
2. è‡ªå®šä¹‰ç¡®è®¤é‚®ä»¶ã€é‡ç½®å¯†ç é‚®ä»¶ç­‰
3. ä½¿ç”¨ä½ çš„å“ç‰Œå’ŒåŸŸå

### è®¾ç½®å¯†ç ç­–ç•¥

1. **Authentication** â†’ **Settings**
2. **Password Requirements**:
   - æœ€å°‘å­—ç¬¦æ•°ï¼š8
   - è¦æ±‚å¤§å°å†™
   - è¦æ±‚æ•°å­—
   - è¦æ±‚ç‰¹æ®Šå­—ç¬¦

---

## ğŸ“ é…ç½®æ£€æŸ¥æ¸…å•

å®Œæˆä»¥ä¸‹é…ç½®åæ‰èƒ½æ­£å¸¸ä½¿ç”¨ï¼š

- [ ] âœ… å·²åœ¨ Supabase Dashboard æ‰§è¡Œ `supabase-schema.sql`
- [ ] âœ… Email Provider å·²å¯ç”¨
- [ ] âœ… å¼€å‘ç¯å¢ƒå…³é—­äº†é‚®ç®±ç¡®è®¤
- [ ] âœ… Site URL å·²é…ç½®ä¸º `http://localhost:3000`
- [ ] âœ… ç¯å¢ƒå˜é‡æ­£ç¡®é…ç½®åœ¨ `.env.local`
- [ ] âœ… é‡å¯äº†å¼€å‘æœåŠ¡å™¨ (`npm run dev`)
- [ ] âœ… æ¸…é™¤äº†æµè§ˆå™¨ç¼“å­˜
- [ ] âœ… å¯ä»¥æˆåŠŸæ³¨å†Œæ–°è´¦å·
- [ ] âœ… å¯ä»¥æˆåŠŸç™»å½•

---

## ğŸ†˜ è¿˜æ˜¯ä¸è¡Œï¼Ÿ

### Debug æ­¥éª¤

1. **æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°**
   - æŸ¥çœ‹å…·ä½“é”™è¯¯ä¿¡æ¯
   - æ£€æŸ¥ç½‘ç»œè¯·æ±‚è¯¦æƒ…

2. **æ£€æŸ¥ Supabase æ—¥å¿—**
   - Dashboard â†’ **Logs** â†’ **Auth**
   - æŸ¥çœ‹è®¤è¯å¤±è´¥åŸå› 

3. **éªŒè¯ç¯å¢ƒå˜é‡**
   ```bash
   # ç¡®è®¤ç¯å¢ƒå˜é‡å·²åŠ è½½
   cat .env.local

   # é‡å¯å¼€å‘æœåŠ¡å™¨
   npm run dev
   ```

4. **æµ‹è¯• Supabase è¿æ¥**
   - è®¿é—®ä½ çš„ Supabase URL
   - ç¡®è®¤é¡¹ç›®æ­£å¸¸è¿è¡Œ

### è”ç³»æ”¯æŒ

å¦‚æœé—®é¢˜ä»æœªè§£å†³ï¼š
1. æŸ¥çœ‹ Supabase æ–‡æ¡£: https://supabase.com/docs/guides/auth
2. Supabase Discord: https://discord.supabase.com
3. æäº¤ issue: https://github.com/supabase/supabase/issues

---

## ğŸ‰ é…ç½®å®Œæˆ

å®Œæˆä»¥ä¸Šé…ç½®åï¼Œä½ çš„åº”ç”¨åº”è¯¥å¯ä»¥ï¼š
- âœ… æ³¨å†Œæ–°ç”¨æˆ·
- âœ… ç™»å½•
- âœ… ä¿å­˜ç”¨æˆ·æ•°æ®
- âœ… ä½¿ç”¨å®Œæ•´çš„ç”¨æˆ·ä½“ç³»

å¼€å§‹äº«å— Supabase å¸¦æ¥çš„å®Œæ•´åç«¯æœåŠ¡å§ï¼
